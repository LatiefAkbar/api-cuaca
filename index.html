<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Grafik Cuaca Modern</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen flex flex-col items-center bg-gradient-to-br from-sky-200 via-indigo-200 to-purple-300 p-6">
  
  <h2 class="text-3xl font-bold text-gray-800 mb-6 drop-shadow">üå§Ô∏è Grafik Cuaca Kota</h2>

  <!-- Form Input -->
  <div class="flex gap-3 mb-10">
    <input 
      type="text" 
      id="kota" 
      placeholder="Masukkan nama kota"
      class="px-4 py-2 rounded-xl shadow-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400 w-64 backdrop-blur bg-white/40 placeholder-gray-700"
    >
    <button 
      onclick="getCuaca()" 
      class="px-5 py-2 rounded-xl bg-indigo-500 hover:bg-indigo-600 text-white font-semibold shadow-md transition">
      Cari
    </button>
  </div>

  <!-- Chart -->
  <div id="chart" class="flex items-end justify-center gap-8 min-h-[300px] w-full max-w-3xl p-6 rounded-2xl 
    bg-gradient-to-tr from-white/40 via-white/20 to-white/10 
    shadow-2xl backdrop-blur-xl border border-white/30">
  </div>

  <script>
    async function getCuaca() {
      const kota = document.getElementById("kota").value.trim();
      if (!kota) {
        alert("Masukkan nama kota terlebih dahulu!");
        return;
      }

      const url = `https://latiefakbarmaulana.rf.gd/cuaca.php?kota=${kota}`;

      try {
        const response = await fetch(url);
        const data = await response.json();

        if (data.status !== "success") {
          alert("Kota tidak ditemukan!");
          return;
        }

        const chartDiv = document.getElementById("chart");
        chartDiv.innerHTML = "";

        const dataset = [
          { label: "Suhu (¬∞C)", value: parseInt(data.suhu), color: "bg-gradient-to-t from-red-500 to-orange-400" },
          { label: "Kelembaban (%)", value: parseInt(data.kelembaban), color: "bg-gradient-to-t from-blue-500 to-cyan-400" },
          { label: "Angin (m/s)", value: parseFloat(data.angin), color: "bg-gradient-to-t from-green-500 to-emerald-400" }
        ];

        dataset.forEach(item => {
          const container = document.createElement("div");
          container.className = "flex flex-col items-center";

          // bar awal scale kecil (animasi scaleY)
          const bar = document.createElement("div");
          bar.className = `w-20 rounded-t-2xl flex items-end justify-center font-bold text-white shadow-lg 
            transform scale-y-0 origin-bottom transition-transform duration-700 ease-out ${item.color}`;
          bar.style.height = (item.value * 4) + "px";
          bar.innerText = item.value;

          const label = document.createElement("div");
          label.className = "mt-3 text-sm font-semibold text-gray-800 drop-shadow";
          label.innerText = item.label;

          container.appendChild(bar);
          container.appendChild(label);
          chartDiv.appendChild(container);

          // trigger animasi
          setTimeout(() => {
            bar.classList.remove("scale-y-0");
            bar.classList.add("scale-y-100");
          }, 100);
        });

        // Scroll otomatis ke chart
        chartDiv.scrollIntoView({ behavior: "smooth" });

      } catch (err) {
        alert("Gagal mengambil data!");
        console.error(err);
      }
    }
  </script>
</body>
</html>
